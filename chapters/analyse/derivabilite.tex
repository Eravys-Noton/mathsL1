\chapter{Dérivabilité et accroissements finis}
\def\arraystretch{1}

\section{Dérivabilité, théorèmes de Rolle et des accroissements finis}
\begin{definition}
	Soient $I \subseteq \R,\ f : I \to \R$, $f$ est dérivable en $a \in I$ si et seulement s'il existe $\ell \in \R$ tel que :
	\begin{align*}
		  \lim_{x \to a} \frac{f(x) - f(a)}{x - a} &= \ell
	\end{align*}
    Une autre manière de définir la dérivabilité :
    \begin{align*}
        \lim_{h \to 0} \frac{f(a + h) - f(a)}{h} &= \ell
    \end{align*}
	On note $f'(a) = \ell$ la dérivée de $f$ en $a$.
	Ainsi une fonction dérivable est une fonction dérivable en tout point de $I$.
	On peut également vérifier la limite à gauche et à droite de $a$.
\end{definition}

\begin{proposition}
	Soient $I \subseteq \R,\ f : I \to \R$ et $a \in I$, si $f$ est \textbf{dérivable} en $a$ alors elle est \textbf{continue} en $a$.
\end{proposition}

\begin{proof}
	Quand $f$ est dérivable en $a$, le développement limité suivant existe :
	\[ f(x) \underset{x \to a}{=} f(a) + f'(a)(x - a) + o(x - a) \]
	En passant à la limite :
	\begin{align*}
		\lim_{x \to a} f(x) &= \lim_{x \to a} \left( f(a) + f'(a)(x - a) + o(x - a) \right) \\
		&= \lim_{x \to a} f(a) + \underbrace{\lim_{x \to a} \left( f'(a)(x - a) + o(x - a) \right)}_{= 0} \\
		\lim_{x \to a} f(x) &= f(a)
	\end{align*}
	ce qui veut dire que $f$ est continue en $a$.
\end{proof}

\begin{theorem}
	Soient $I \subseteq \R$, $a \in I$, $\lambda \in \R$ et $f, g$ deux fonctions dérivables en $a$.
	\begin{enumerate}
		\item $f + \lambda g$ est dérivable en $a$ et $(f + \lambda g)'(a) = f'(a) + \lambda g'(a)$.
		\item $f g$ est dérivable en $a$ et $(fg)'(a) = f'(a) g(a) + f(a) g'(a)$.
	\end{enumerate}
\end{theorem}

\begin{proof}
	\leavevmode
	\begin{enumerate}
		\item On calcule $\lim_{x \to a} \frac{f(x) + \lambda g(x) - (f(a) + \lambda g(a))}{x - a}$.
		\begin{align*}
			\lim_{x \to a} \frac{f(x) + \lambda g(x) - (f(a) + \lambda g(a))}{x - a} &= \lim_{x \to a} \frac{f(x) + \lambda g(x) - f(a) - \lambda g(a)}{x - a} \\
			&= \lim_{x \to a} \frac{f(x) - f(a)}{x - a} + \lambda \lim_{x \to a} \frac{g(x) - g(a)}{x - a} \\
			&= f'(a) + \lambda g'(a)
		\end{align*}
		\item On calcule $\lim_{x \to a} \frac{(fg)(x) - (fg)(a)}{x - a}$. On utilise le fait qu'une fonction dérivable en $a$ est continue en $a$ et la définition de la continuité en $a$.
		\begin{align*}
			\lim_{x \to a} \frac{(fg)(x) - (fg)(a)}{x - a} &= \lim_{x \to a} \frac{f(x) g(x) - f(a) g(a)}{x - a} \\
			&= \lim_{x \to a} \left[ \frac{f(x) g(x) - f(a) g(a)}{x - a} + g(x) \frac{f(x) - f(a)}{x - a} \right] \\
			&= \lim_{x \to a} \frac{f(x)g(x) - f(a)g(a)}{x - a} + \lim_{x \to a} g(x) \frac{f(x) - f(a)}{x - a} \\
			&= f(a) \lim_{x \to a} \frac{g(x) - g(a)}{x - a} + g(a) \lim_{x \to a} \frac{f(x) - f(a)}{x - a} \\
			&= f(a) g'(a) + f'(a) g(a)
		\end{align*}
	\end{enumerate}
\end{proof}

\begin{theorem}[\cite{derivation_wikiversite}]
	Soient $I, J \subseteq \R$, $f : I \to \R$ et $g : J \to \R$ telles que $f(I) \subseteq J$ et $a$ un point de $I$. \\
	Si $f$ est dérivable au point $a$ et $g$ est dérivable au point $f(a)$ alors la composée $g \circ f$ est dérivable au point $a$ et :
	\[ (g \circ f)'(a) = g'(f(a)) f'(a) \]
\end{theorem}

\begin{proof}
	\cite{derivation_wikiversite}. Notons $b = f(a)$. Puisque $g$ est dérivable en $b$, il existe une fonction $u : J \to \R$ telle que :
	\[ u(b) = \lim_{y \to b} u(y) = g'(b) \]
	et $\forall y \in J :$ 
	\[ g(y) - g(b) = u(y) (y - b) \]
	En particulier, $f$ est continue au point $a$ car elle y est dérivable: 
	\[ \lim_{x \to a} u(f(x)) = g'(b) \]
	et $\forall x \in I :$
	\[ g(f(x)) - g(f(a)) = u(f(x)) (f(x) - f(a)) \]
	Le taux de variation au point $a$ de la fonction $g \circ f$ s'exprime alors sous la forme :
	\[ \frac{g(f(x)) - g(f(a))}{x - a} = u(f(x)) \cdot \frac{f(x) - f(a)}{x - a} \]
	et quand $x$ tend vers $a$, cette expression tend vers $g'(b) \cdot f'(a) = g'(f(a)) f'(a)$.
\end{proof}

\begin{definition}[Maximum, minimum]
    Soient $I \subseteq \R,\ f : I \to \R$ et $a \in I$.
    \begin{enumerate}
        \item On dit que $a$ est un \textbf{maximum} si et seulement si : $\forall x \in I,\ f(a) \geq f(x)$.
        \item On dit que $a$ est un \textbf{minimum} si et seulement si : $\forall x \in I,\ f(a) \leq f(x)$.
    \end{enumerate}
    On appelle extremum un point qui est soit un maximum soit un minimum.
    \begin{enumerate}
        \item On dit que $a$ est un \textbf{maximum local} si et seulement si : $\exists \varepsilon > 0,\ a \text{ est un maximum de } f_{|]a - \varepsilon, a + \varepsilon[}$.
        \item On dit que $a$ est un \textbf{minimum local} si et seulement si : $\exists \varepsilon > 0,\ a \text{ est un minimum de } f_{|]a - \varepsilon, a + \varepsilon[}$.
    \end{enumerate}
\end{definition}

\begin{theorem}
	Soient $I \subseteq \R,\ f : I \to \R$ une fonction dérivable et $a \in \overset{\circ}{I}$, $\overset{\circ}{I}$ désigne l'intérieur de $I$. 
	\[ a \text{ est un extremum local} \implies f'(a) = 0 \]
\end{theorem}

\begin{proof}
	Soient $a$ un extremum local et $f_{|]a - \varepsilon, a + \varepsilon[}$.
	\\
	\begin{enumerate}
		\item Quand $h > 0$ : 
		\[ \frac{f(a + h) - f(a)}{h} \leq 0,\ \lim_{h \to 0} f'(a) \leq 0 \]
		\item Quand $h < 0$ :
		\[ \frac{f(a + h) - f(a)}{h} \geq 0,\ \lim_{h \to 0} f'(a) \geq 0 \]
	\end{enumerate}
	alors $f'(a) = 0$.
\end{proof}

\begin{theorem}[Théorème de Rolle]
    Soient $a, b \in \R$ tels que $a < b$ et $f : [a, b] \to \R$ une fonction telle que :
    \begin{enumerate}
            \item $f$ est continue sur $[a, b]$.
            \item $f$ est dérivable sur $]a, b[$.
            \item $f(a) = f(b)$.
        \end{enumerate}
    \par \noindent Il existe un $c \in \ ]a, b[$ tel que : \[ f'(c) = 0 \]
\end{theorem}

\begin{proof}\cite{exo7_analyse1}
	\leavevmode
	\begin{enumerate}
		\item Si $f$ est constante, alors n'importe quel $c \in \ ]a, b[$ convient.
		\item Sinon il existe $x_0 \in [a, b]$ tel que $f(x_0) \neq f(a)$. 
		\\
		Supposons par exemple $f(x_0) > f(a)$. Alors $f$ est continue sur $[a, b]$, donc elle admet un maximum en un point $c \in [a, b]$. Mais $f(c) \geq f(x_0) > f(a)$ donc $c \neq a$. De même comme $f(a) = f(b)$ alors $c \neq b$. Ainsi $c \in \ ]a, b[$. En $c$, $f$ est dérivable et admet un maximum local donc $f'(c) = 0$.
	\end{enumerate}
\end{proof}

\begin{theorem}[Théorème des accroissements finis]
    Soient $a, b \in \R$ tels que $a < b$ et $f : [a, b] \to \R$, telle que : 
    \begin{enumerate}
            \item $f$ est continue sur $[a, b]$.
            \item $f$ est dérivable sur $]a, b[$.
        \end{enumerate}
    \par \noindent Il existe un $c \in ]a, b[$ tel que :
	\[ f'(c) = \frac{f(b) - f(a)}{b - a} \]
\end{theorem}

\begin{proof}\cite{exo7_analyse1}
	Posons $\ell = \frac{f(b) - f(a)}{b - a}$ et $g(x) = f(x) - \ell (x - a)$.
	 \\
	 Alors $g(a) = f(a),\ g(b) = f(b) - \frac{f(b) - f(a)}{b - a} \cdot (b - a) = f(a)$.
	 \\
	  Par le théorème de Rolle, il existe un $c \in \ ]a, b[$ tel que $g'(c) = 0$. Or $g'(x) = f'(x) - \ell$. Ce qui donne $f'(c) = \frac{f(b) - f(a)}{b - a}$.
\end{proof}

\begin{corollary}[Inégalité des accroissements finis]
	Soient $a,b \in \R$ tels que $a < b$, $f : \ ]a, b[ \to \R$ une fonction dérivable sur $]a, b[$ et $M$ une constante telle que pour tout $x \in \ ]a, b[,\ \abs{f'(x)} \leq M$.
	\[ \abs{\frac{f(b) - f(a)}{b - a}} \leq M \]
\end{corollary}

\begin{proof}
	D'après le théorème des accroissements finis, il existe un $c \in \ ]a, b[$ tel que $\frac{f(b) - f(a)}{b - a}$. Or pour tout $x \in \ ]a, b[$, $\abs{f'(x)} \leq M$ donc $\abs{f'(c)} \leq M$ et donc :
	\[ \abs{\frac{f(b) - f(a)}{b - a}} \leq M \]
\end{proof}

\begin{proposition}[\cite{exo7_analyse1}]
    Soient $f : [a, b] \to \R$ une fonction continue sur $[a, b]$ et dérivable sur $]a, b[$.
    \begin{enumerate}
            \item $\forall x \in \ ]a, b[,\ f'(x) \geq 0 \iff f \text{ croissante}$.
            \item $\forall x \in \ ]a, b[,\ f'(x) \leq 0 \iff f \text{ décroissante}$.
            \item $\forall x \in \ ]a, b[,\ f'(x) = 0 \iff f \text{ constante}$.
            \item $\forall x \in \ ]a, b[,\ f'(x) > 0 \implies f \text{ strictement croissante}$.
            \item $\forall x \in \ ]a, b[,\ f'(x) < 0 \implies f \text{ strictement décroissante}$ .
        \end{enumerate}
\end{proposition}

\begin{proof}
	Montrons le 1. 
	\\
	\boxed{\implies} : Supposons que pour $x \in \ ]a, b[,\ f'(x) \geq 0$. \\
	Soient $x, y \in \ ]a, b[$ tels que $x \leq y$. D'après le théorème des accroissements finis, il existe un $c \in \ ]x, y[$ tel que $\frac{f(x) - f(y)}{x - y} = f'(c)$.
	\[ f(x) - f(y) = f'(c)(x - y) \]
	Or $f'(x) \geq 0$ pour $x \in \ ]a, b[$ donc $f'(c) \geq 0$ et $x \leq y$ donc $x - y \leq 0$ et $f(x) - f(y) \leq 0$ donc  $f(x) \leq f(y)$.
	\\
	\boxed{\impliedby} : Supposons que pour $x, y \in \ ]a, b[$ tels que $x \leq y$ et $f(x) \leq f(y)$. \\
	On a donc :
	\begin{align*}
		f(y) - f(x) &\geq 0 \\
		\frac{f(y) - f(x)}{y - x} &\geq 0 
	\end{align*}
	On sait que :
	\[ \lim_{y \to x} \frac{f(y) - f(x)}{y - x} = f'(x) \]
	donc :
	\[ f'(x) \geq 0 \]
\end{proof}

\begin{definition}
	Soient $I \subseteq \R,\ f : I \to \R$ et $n \in \N$.
	\begin{enumerate}
		\item $f \in \mathcal{D}^n(I, \R)$ signifie que $f$ est $n$ fois dérivable sur $I$.
		\item $f \in \mathcal{C}^n(I, \R)$ signifie que $f$ est $n$ fois dérivable et que sa dérivée $n$-ième est continue.
		\item $f \in \mathcal{C}^{\infty}(I, \R) = \mathcal{D}^{\infty}(I, \R)$ signifie que $f \in \mathcal{C}^n(I, \R),\ \forall n \in \N$. On dit que les fonctions $\mathcal{C}^{\infty}$ sont des \textbf{fonctions lisses}.
	\end{enumerate}
\end{definition}

\begin{proposition}
	$\forall f, g \in \mathcal{C}^n(I, \R) \implies f + g, f \cdot g, f \circ g \in \mathcal{C}^n(I, \R)$
\end{proposition}

\section{Convexité}
\begin{definition}
    Soient $I \subseteq \R,\ f : I \to \R$.
    \begin{enumerate}
        \item On dit que $f$ est \textbf{convexe} si et seulement si : 
        \[ \forall x, y \in I,\ \lambda \in [0, 1] : f(\lambda x + (1 - \lambda)y) \leq \lambda f(x) + (1 - \lambda) f(y) \]
        \item On dit que $f$ est \textbf{concave} si et seulement si : 
        \[ \forall x, y \in I,\ \lambda \in [0, 1] : f(\lambda x + (1 - \lambda)y) \geq \lambda f(x) + (1 - \lambda) f(y) \]
    \end{enumerate}
\end{definition}

\par Géométriquement, $f$ est convexe signifie que son graphe passe sous les cordes de $f$ et que les tangentes passent sous le graphe. $f$ est concave signifie que son graphe au-dessus des cordes de $f$ et que les tangentes passent par-dessus le graphe.

\begin{theorem}
	Soient $I \subseteq \R,\ f \in \mathcal{D}^2(I, \R)$.
        \begin{enumerate}
                \item $f \text{ convexe} \iff f'' \geq 0$.
                \item $f \text{ concave} \iff f'' \leq 0$.
            \end{enumerate}
\end{theorem}

\begin{theorem}[Inégalité de Jensen]
	Soient $I \subseteq \R$, $f : I \to \R$ une fonction convexe, $x_i \in I$ et $\lambda_i \in [0, 1]$ tels que $\sum_{i=1}^n \lambda_i = 1$.
	\[ f \left( \sum_{i=1}^{n} \lambda_i x_i \right) \leq \sum_{i=1}^{n} \lambda_i f(x_i) \]
\end{theorem}

\begin{proof}
	contenu...
\end{proof}

\begin{proposition}
	Soient $I \subseteq \R,\ f : I \to \R$ et $a \in I$, la tangente de $f$ en $a$ est :
	\[ \mathcal{T}_a(x) = f(a) + f'(a)(x - a) \]
\end{proposition}

\begin{proposition}
	Soient $a, b \in \R$ tels que $a < b,\ f : [a, b] \to \R$.
	La corde $c$ reliant les points $(a, f(a))$ et $(b, f(b))$ est définie par l'équation suivante :
	\[ c = \frac{f(b) - f(a)}{b - a} (x - a) + f(a) \]
\end{proposition}

\begin{proposition}
	Soient $I \subseteq \R,\ f \in \mathcal{D}^2(I, \R),\ a \in I$.
	\begin{align*}
		\begin{cases}
			f'(a) = 0 \\
			f''(a) < 0
		\end{cases}
		\implies a \text{ est un maximum local, si } f''(a) > 0,\ a \text{  est un minimum local}
	\end{align*}
\end{proposition}

\begin{definition}[Suite récurrente]
	Soient $I \subseteq \R,\ f : I \to \R$ et $u_0 \in I$.
	Si $\forall n \in \N,\ u_n \in I$ alors on peut définir :
	\[ u_{n + 1} = f(u_n) \]
\end{definition}

\begin{lemma}
	Soit $I \subseteq \R$. S'il existe un $\ell \in I$ tel que $\lim_{n \to +\infty} u_n = \ell$ et si $f$ est continue en $\ell$ alors 
	\[ f(\ell) = \ell \]
\end{lemma}

\begin{definition}
	Soient $I \subseteq \R,\ f : I \to \R$. On dit que $f$ est stable sur $I$ si et seulement si : 
	\[ f(I) \subseteq I \]
\end{definition}

\begin{proposition}
	Soit $I \subseteq \R$.
	Si $f$ est \textbf{croissante} sur $I$ alors 
	$
	(u_n)_{n \in \N} = 
	\begin{cases}
		u_0 \in I \\
		u_{n + 1} = f(u_n)
	\end{cases}
	$
	est monotone.
	\[ u_1 \geq u_0 \iff (u_n) \text{ croissante} \]
	\[ u_1 \leq u_0 \iff (u_n) \text{ décroissante} \]
	Si $f$ est \textbf{décroissante} sur $I$, alors les suites extraites $(v_n)_{n \in \N} = u_{2n}$ et $(w_n)_{n \in \N} = u_{2n + 1}$ sont monotones, l'une est \textbf{croissante}, l'autre est \textbf{décroissante}.
\end{proposition}

\begin{definition}[Point fixe]
	Soient $f : \mathcal{D}_f \to \R$ et $x \in \mathcal{D}_f,\ f(x) = x$. On dit que $x$ est un \textbf{point fixe} de $f$.
\end{definition}

\begin{definition}[Coefficient de convergence]
    Soient $(u_n)_{n \in \N}$ tel que $\lim_{n \to +\infty} u_n = \ell \in \R$, $\varepsilon_n = \abs{u_n - \ell}$ et supposons que $\lim_{n \to +\infty} \frac{\varepsilon_{n + 1}}{\varepsilon_n} = K \in \R_+$. 
    On appelle $K$ coefficient de la convergence.
    \begin{itemize}
        \item Si $K = 1$ la convergence est \textbf{lente}.
        \item Si $K = 0$ la convergence est \textbf{rapide}.
        \item Si $0 < K < 1$ la convergence est \textbf{géométrique}.
    \end{itemize}
\end{definition}

\begin{definition}[Fonction contractante]
	Soient $I \subseteq \R,\ f : I \to \R$.
    On dit que $f$ est \textbf{contractante} si et seulement si :
    \[ \exists k \in \ ]0, 1[,\ \forall x, y \in I : \abs{f(x) - f(y)} \leq k \abs{x - y} \]
\end{definition}

\begin{theorem}[Théorème du point fixe]
	Soient $I$ un intervalle fermé et $f : I \to I$ une fonction contractante et continue et $(u_n)_{n \in \N}$ sa suite récurrente associée.
	\begin{enumerate}
        \item Il existe un unique point fixe $\ell \in I$.
        \item $\lim_{n \to +\infty} u_n = \ell$.
        \item La convergence de $(u_n)_{n \in \N}$ est géométrique.
    \end{enumerate}
\end{theorem}

\begin{theorem}[Suites récurrentes linéaires d'ordre 2]
	Soit $u_{n+2} = a u_{n+1} + b u_n$ pour $a, b \in \R$.
	On pose l'équation suivante pour $r \in \R$ :
	\[ r^2 - ar - b = 0 \qquad \Delta = a^2 + 4b \]
	Pour $\lambda, \mu, \alpha \in \R$ :
	\begin{itemize}
        \item $\Delta > 0 \implies u_n = \lambda r_1^n + \mu r_2^n$ avec $r_1, r_2$ tels que :
        \begin{align*}
            r_1 &= \frac{a - \sqrt{\Delta}}{2} & r_2 &= \frac{a + \sqrt{\Delta}}{2}
        \end{align*}
        \item $\Delta = 0 \implies u_n = (\lambda + \mu n) r_0^n$ avec $r_0$ tel que :
        \begin{align*}
            r_0 = \frac{a}{2}
        \end{align*}
        \item $\Delta < 0 \implies u_n = \lambda r^n \cos(n \alpha) + \mu r^n \sin(n \alpha)$ avec les racines de la forme $re^{i\alpha}$ et $re^{-i\alpha}$.
    \end{itemize}    
    On trouve $\lambda, \mu$ grâce aux conditions sur les deux premiers termes de la suite.
\end{theorem}
